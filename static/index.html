<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Burner Mail Cloudflare</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <link rel="stylesheet" href="./css/index/style.css">
</head>
<body class="bg-slate-900 text-slate-100 h-screen flex overflow-hidden">

    <aside id="sidebar" class="sidebar bg-slate-800 border-r border-slate-700 flex flex-col justify-between shadow-2xl relative z-40 shrink-0">
        <div class="flex flex-col h-full">
            <div class="logo-area h-16 flex items-center px-6 border-b border-slate-700 relative transition-all">
                <i class="fa-solid fa-fire text-orange-500 text-2xl shrink-0"></i>
                <span class="sidebar-text font-bold text-xl ml-3 tracking-tight">Burner<span class="text-orange-500">Mail</span></span>
                <button onclick="toggleSidebar()" class="absolute -right-3 top-6 bg-orange-600 rounded-full w-6 h-6 flex items-center justify-center text-xs shadow-lg hover:bg-orange-500 transition border border-slate-900 z-50">
                    <i class="fa-solid fa-chevron-left transition-transform duration-300" id="chevron"></i>
                </button>
            </div>
            <nav class="flex-1 py-6 space-y-2 px-3">
                <button onclick="switchTab('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center p-3 rounded-lg text-slate-400 hover:bg-slate-700 hover:text-white transition group">
                    <i class="fa-solid fa-inbox w-6 text-center text-lg shrink-0 transition-all"></i>
                    <span class="sidebar-text ml-3 font-medium">Ativos</span>
                </button>
                <button onclick="switchTab('history')" id="nav-history" class="nav-item w-full flex items-center p-3 rounded-lg text-slate-400 hover:bg-slate-700 hover:text-white transition group">
                    <i class="fa-solid fa-clock-rotate-left w-6 text-center text-lg shrink-0 transition-all"></i>
                    <span class="sidebar-text ml-3 font-medium">Histórico</span>
                </button>
                <button onclick="switchTab('config')" id="nav-config" class="nav-item w-full flex items-center p-3 rounded-lg text-slate-400 hover:bg-slate-700 hover:text-white transition group">
                    <i class="fa-solid fa-gear w-6 text-center text-lg shrink-0 transition-all"></i>
                    <span class="sidebar-text ml-3 font-medium">Configurações</span>
                </button>
            </nav>

            <div class="p-3 border-t border-slate-700">
                <button onclick="logout()" class="logout-btn w-full flex items-center p-3 rounded-lg text-red-400 hover:bg-red-500/10 transition group cursor-pointer">
                    <i class="fa-solid fa-right-from-bracket w-6 text-center text-lg shrink-0 transition-all"></i>
                    <span class="sidebar-text ml-3 font-medium">Sair</span>
                </button>
                <div class="text-center mt-2 overflow-hidden">
                    <span class="sidebar-text text-[10px] text-slate-500 uppercase tracking-widest">v6.3 Precision Delete</span>
                </div>
            </div>
        </div>
    </aside>

    <main class="flex-1 flex flex-col relative overflow-hidden bg-slate-900 w-full">
        <header class="h-16 bg-slate-800/50 backdrop-blur-md border-b border-slate-700 flex items-center px-8 justify-between shrink-0 relative z-30">
            <h2 id="page-title" class="text-lg font-bold text-white">Dashboard</h2>
            
            <div id="create-btn-area" class="relative z-50">
                <div class="flex shadow-lg rounded-lg overflow-hidden">
                    <button onclick="openCreateModal()" class="bg-orange-600 hover:bg-orange-500 text-white font-bold py-2 px-4 flex items-center gap-2 transition text-sm border-r border-orange-700">
                        <i class="fa-solid fa-plus"></i> <span class="hidden sm:inline">Gerar Email</span>
                    </button>
                    <button onclick="toggleCreateDropdown()" class="bg-orange-600 hover:bg-orange-500 text-white px-3 transition text-sm flex items-center">
                        <i class="fa-solid fa-caret-down"></i>
                    </button>
                </div>

                <div id="create-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-slate-800 border border-slate-700 rounded-lg shadow-xl overflow-hidden z-50">
                    <button onclick="openCreateModal()" class="w-full text-left px-4 py-3 text-sm text-slate-300 hover:bg-slate-700 hover:text-white transition flex items-center gap-2">
                        <i class="fa-solid fa-dice text-orange-500"></i> Gerar Aleatório
                    </button>
                    <button onclick="openCustomModal()" class="w-full text-left px-4 py-3 text-sm text-slate-300 hover:bg-slate-700 hover:text-white transition flex items-center gap-2 border-t border-slate-700">
                        <i class="fa-solid fa-pen-to-square text-blue-500"></i> Email Personalizado
                    </button>
                </div>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto p-8 relative scroll-smooth z-0">
            
            <div id="view-dashboard" class="view-section">
                <div id="active-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
                <div id="empty-dashboard" class="hidden h-full flex flex-col items-center justify-center opacity-40 mt-20">
                    <i class="fa-solid fa-envelope-open-text text-6xl mb-4"></i>
                    <p class="text-xl">Nenhum email ativo.</p>
                </div>
            </div>

            <div id="view-history" class="view-section hidden">
                <div class="mb-6 flex gap-2">
                    <div class="relative flex-1">
                        <i class="fa-solid fa-magnifying-glass absolute left-3 top-3 text-slate-500"></i>
                        <input type="text" id="history-search" onkeyup="filterHistory()" placeholder="Buscar por email, destino ou tags..." class="w-full bg-slate-800 border border-slate-700 rounded-lg py-2.5 pl-10 pr-4 text-white focus:border-orange-500 outline-none">
                    </div>
                </div>

                <div class="bg-slate-800 rounded-xl overflow-hidden shadow-xl border border-slate-700">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left min-w-[600px]">
                            <thead class="bg-slate-900 text-slate-400 text-xs uppercase font-bold">
                                <tr>
                                    <th class="p-4">Alias</th>
                                    <th class="p-4">Tags</th>
                                    <th class="p-4">Encaminhado Para</th>
                                    <th class="p-4">Criado em</th>
                                    <th class="p-4 text-center">Status</th>
                                    <th class="p-4 text-right">Ações</th>
                                </tr>
                            </thead>
                            <tbody id="history-table" class="divide-y divide-slate-700 text-sm text-slate-300"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="view-config" class="view-section hidden max-w-4xl mx-auto space-y-8">
                <div class="bg-slate-800 p-8 rounded-xl shadow-lg border border-slate-700">
                    <h3 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
                        <i class="fa-brands fa-cloudflare text-orange-500"></i> Credenciais Cloudflare
                    </h3>
                    <form onsubmit="saveConfig(event)" class="grid grid-cols-1 gap-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-400 uppercase mb-1">API Token</label>
                            <input type="password" id="cfg-token" class="w-full bg-slate-900 border border-slate-600 rounded p-3 text-orange-400 font-mono focus:border-orange-500 outline-none" placeholder="Token de API" required>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-bold text-slate-400 uppercase mb-1">Zone ID</label>
                                <input type="text" id="cfg-zone" class="w-full bg-slate-900 border border-slate-600 rounded p-3 text-white focus:border-orange-500 outline-none" required>
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-slate-400 uppercase mb-1">Domínio</label>
                                <input type="text" id="cfg-domain" class="w-full bg-slate-900 border border-slate-600 rounded p-3 text-white focus:border-orange-500 outline-none" placeholder="ex: meudominio.com" required>
                            </div>
                        </div>
                        <button type="submit" class="bg-slate-700 hover:bg-green-600 text-white font-bold py-3 rounded mt-2 transition shadow">
                            <i class="fa-solid fa-save mr-2"></i> Salvar Credenciais
                        </button>
                    </form>
                </div>

                <div class="bg-slate-800 p-8 rounded-xl shadow-lg border border-slate-700">
                    <h3 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-key text-blue-500"></i> Alterar Senha de Acesso
                    </h3>
                    <form onsubmit="changePassword(event)" class="grid grid-cols-1 gap-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-400 uppercase mb-1">Senha Atual</label>
                            <input type="password" id="pwd-current" class="w-full bg-slate-900 border border-slate-600 rounded p-3 text-white focus:border-blue-500 outline-none" required>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-bold text-slate-400 uppercase mb-1">Nova Senha</label>
                                <input type="password" id="pwd-new" class="w-full bg-slate-900 border border-slate-600 rounded p-3 text-white focus:border-blue-500 outline-none" required>
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-slate-400 uppercase mb-1">Confirmar Nova Senha</label>
                                <input type="password" id="pwd-confirm" class="w-full bg-slate-900 border border-slate-600 rounded p-3 text-white focus:border-blue-500 outline-none" required>
                            </div>
                        </div>
                        <button type="submit" id="btn-change-pwd" class="bg-slate-700 hover:bg-blue-600 text-white font-bold py-3 rounded mt-2 transition shadow flex justify-center items-center gap-2">
                            <i class="fa-solid fa-shield-halved"></i> Atualizar Senha
                        </button>
                    </form>
                </div>

                <div class="bg-slate-800 p-8 rounded-xl shadow-lg border border-slate-700">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-white flex items-center gap-2">
                            <i class="fa-solid fa-users-gear text-emerald-500"></i> Gerenciar Destinos
                        </h3>
                        <div class="flex gap-2">
                            <button onclick="loadDestinations()" class="text-xs bg-slate-700 hover:bg-slate-600 px-3 py-1 rounded transition border border-slate-600">
                                <i class="fa-solid fa-sync"></i>
                            </button>
                            <button onclick="openAddDestModal()" class="text-xs bg-blue-600 hover:bg-blue-500 text-white px-3 py-1 rounded transition font-bold shadow">
                                <i class="fa-solid fa-plus mr-1"></i> Adicionar
                            </button>
                        </div>
                    </div>
                    <div class="space-y-3" id="dest-list"></div>
                </div>
            </div>

        </div>
    </main>

    <div id="toast-container" class="fixed bottom-5 right-5 z-50 flex flex-col gap-3 pointer-events-none"></div>

    <div id="create-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 border border-slate-600 rounded-xl shadow-2xl max-w-md w-full p-6 relative transform transition-all scale-100">
            <button onclick="closeCreateModal()" class="absolute top-4 right-4 text-slate-400 hover:text-white"><i class="fa-solid fa-xmark text-xl"></i></button>
            <h3 class="text-xl font-bold text-white mb-4">Gerar Novo Email</h3>
            <div id="create-modal-loading" class="flex flex-col items-center justify-center py-8">
                <i class="fa-solid fa-circle-notch fa-spin text-3xl text-orange-500 mb-2"></i>
                <p class="text-slate-500 text-sm">Carregando destinos...</p>
            </div>
            <div id="create-modal-content" class="hidden">
                <div class="mb-4">
                    <label class="block text-xs font-bold text-slate-400 uppercase mb-2">Destino Real</label>
                    <select id="modal-dest-select" class="dest-select-target w-full bg-slate-900 border border-slate-600 rounded p-3 text-white outline-none focus:border-orange-500"></select>
                </div>
                <div class="mb-6 relative">
                    <label class="block text-xs font-bold text-slate-400 uppercase mb-2">Tags</label>
                    <div class="tag-input-container" onclick="document.getElementById('tag-input-create').focus()">
                        <div id="tags-container-create" class="flex flex-wrap gap-2"></div>
                        <input type="text" id="tag-input-create" class="tag-input-field" placeholder="Add tag..." autocomplete="off">
                    </div>
                    <div id="suggestions-create" class="suggestions-list"></div>
                </div>
                <button onclick="confirmCreateEmail()" id="btn-confirm-create" class="w-full bg-orange-600 hover:bg-orange-500 text-white font-bold py-3 rounded shadow-lg transition flex justify-center items-center gap-2">
                    <i class="fa-solid fa-magic-wand-sparkles"></i> Gerar Agora
                </button>
            </div>
        </div>
    </div>

    <div id="custom-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 border border-slate-600 rounded-xl shadow-2xl max-w-md w-full p-6 relative transform transition-all scale-100">
            <button onclick="closeCustomModal()" class="absolute top-4 right-4 text-slate-400 hover:text-white"><i class="fa-solid fa-xmark text-xl"></i></button>
            <h3 class="text-xl font-bold text-white mb-2">Email Personalizado</h3>
            <div id="custom-modal-loading" class="flex flex-col items-center justify-center py-8">
                <i class="fa-solid fa-circle-notch fa-spin text-3xl text-blue-500 mb-2"></i>
                <p class="text-slate-500 text-sm">Preparando...</p>
            </div>
            <div id="custom-modal-content" class="hidden">
                <div class="space-y-4 mb-6">
                    <div>
                        <label class="block text-xs font-bold text-slate-400 uppercase mb-2">Alias Desejado</label>
                        <div class="flex items-center">
                            <input type="text" id="custom-alias-input" class="flex-1 bg-slate-900 border border-r-0 border-slate-600 rounded-l p-3 text-white outline-none focus:border-blue-500" placeholder="ex: netflix-teste">
                            <span id="domain-suffix" class="bg-slate-700 border border-l-0 border-slate-600 rounded-r p-3 text-slate-300 text-sm font-mono">...</span>
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-400 uppercase mb-2">Destino Real</label>
                        <select id="custom-dest-select" class="dest-select-target w-full bg-slate-900 border border-slate-600 rounded p-3 text-white outline-none focus:border-blue-500"></select>
                    </div>
                    <div class="relative">
                        <label class="block text-xs font-bold text-slate-400 uppercase mb-2">Tags</label>
                        <div class="tag-input-container" onclick="document.getElementById('tag-input-custom').focus()">
                            <div id="tags-container-custom" class="flex flex-wrap gap-2"></div>
                            <input type="text" id="tag-input-custom" class="tag-input-field" placeholder="Add tag..." autocomplete="off">
                        </div>
                        <div id="suggestions-custom" class="suggestions-list"></div>
                    </div>
                </div>
                <button onclick="confirmCustomEmail()" id="btn-confirm-custom" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded shadow-lg transition flex justify-center items-center gap-2">
                    <i class="fa-solid fa-check"></i> Criar Personalizado
                </button>
            </div>
        </div>
    </div>

    <div id="add-dest-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 border border-slate-600 rounded-xl shadow-2xl max-w-md w-full p-6 relative">
            <button onclick="closeAddDestModal()" class="absolute top-4 right-4 text-slate-400 hover:text-white"><i class="fa-solid fa-xmark text-xl"></i></button>
            <h3 class="text-xl font-bold text-white mb-2">Adicionar Novo Destino</h3>
            <p class="text-slate-400 text-sm mb-6">O Cloudflare enviará um email de confirmação.</p>
            <div class="mb-6">
                <label class="block text-xs font-bold text-slate-400 uppercase mb-2">Endereço de Email</label>
                <input type="email" id="new-dest-input" class="w-full bg-slate-900 border border-slate-600 rounded p-3 text-white outline-none focus:border-blue-500" placeholder="voce@gmail.com">
            </div>
            <button onclick="confirmAddDest()" id="btn-confirm-add" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded shadow-lg transition flex justify-center items-center gap-2">
                <i class="fa-solid fa-paper-plane"></i> Enviar Solicitação
            </button>
        </div>
    </div>

    <div id="confirm-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 border border-slate-600 rounded-xl shadow-2xl max-w-sm w-full p-6 relative transform transition-all scale-100">
            <h3 id="confirm-title" class="text-xl font-bold text-white mb-2">Confirmação</h3>
            <p id="confirm-desc" class="text-slate-400 text-sm mb-6">Tem certeza?</p>
            <div class="flex gap-3">
                <button onclick="closeConfirmModal()" class="flex-1 py-2 rounded-lg border border-slate-600 text-slate-300 hover:bg-slate-700 hover:text-white transition font-medium text-sm">Cancelar</button>
                <button id="btn-modal-confirm-action" class="flex-1 py-2 rounded-lg bg-orange-600 hover:bg-orange-500 text-white font-bold shadow-lg transition text-sm">Sim, Confirmar</button>
            </div>
        </div>
    </div>
    <script src="./js/index/main.js"></script>
</body>
</html>